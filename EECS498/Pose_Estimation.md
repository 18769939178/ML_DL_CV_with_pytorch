# 人体姿态估计

人体姿态估计是计算机视觉领域的一个方向，任务是识别出图像中人体的姿态，主流方式是确定人体上若干个关键点（比如说关节、眼睛等）的位置并且进行相连，对人体姿态的估计有利于完成一系列更高级别的任务，如动作识别

## 应用

人体姿态估计的一个应用就是人机交互，让计算机可以理解人在做什么动作并且做出相关的响应，比如说识别舞蹈动作，然后就是视频监控领域，可以识别行为并且做出判断，比如说检测老人跌倒的情况

## 挑战

人体姿态估计的一些主要问题如下

1. 关节或者说关键点之间具有强烈的连接关系
2. 关键点（关节）存在不可见（或者遮挡）和形状微小的问题
3. 需要从上下文中获取某些信息
4. 人的尺度不一样，一个图片中可能存在多种大小的人

## 历史

最早的人体姿态估计的，可以追溯到计算机视觉的早期，一种经典的方法就是**Pictorial Strictures (PSs，形变部件模型)**，早在1973年就由Fischler和Elshlager提出，对人体姿态估计领域影响深远，并且被Felzenszwalb和Huttenlocher改造的更加易用（通过距离变换方式）。它的基本思想是将目标对象（如人体）模型化为一个多部件的结构，并使用图形模型（通常是树形图）来表示部件之间的关系。

当然，这种方法也有限制，比如说需要手工设计特征等，所以很难大规模应用

深度学习背景的人体姿态方法估计在2014年被提出，即DeepPose: Human Pose Estimation via Deep Neural Networks这篇文章，其中首次提出了使用深度神经网络去判断人体姿态的方案，不过在这里的方案是基于回归实现的，作者提出的方法是对关键点进行回归，输入信号是整张图片，这样就可以解决上下文问题，同时不需要显式地注意模型拓扑和关节之间的交互

## 主流方法

目前，二维单人姿态估计有两种主流方法，一种是基于直接回归坐标的方式（DeepPose），包括CNN多阶段回归模型和CNN多阶段反馈回归模型，一种是基于热力图回归坐标的（CPM或者说姿态机和Hourlgass等），比如说CNN+图模型（使用图模型或者树模型进行精细化等）、CNN多阶段回归和检测加回归（这是一种混合模型）等，还有基于GNN图模型进行估计

## DeepPose

这种方法，将k个人体关节视为k个点，每个点有两个坐标属性，然后k个点合并为一个k维向量，这也就是标签值，同时，因为坐标都属于图像坐标系并且有范围，故可以进行归一化处理，将一张图片归一化为224大小，同时坐标也进行归一化处理

DeepPose的主要步骤包括：

1. 提出一个初始的关节点估计：首先，DeepPose会使用一个卷积神经网络（CNN）对每个关节点进行一个粗略的估计。这个网络的输入是整个图像，输出是所有关节点的坐标。
2. 迭代优化关节点估计：然后，DeepPose会使用一个序列的卷积神经网络来迭代优化关节点的估计。每个网络的输入是上一步估计的关节点周围的图像块，输出是对关节点坐标的更新（或者说学习到的偏移量）。通过这种方式，DeepPose能够逐步提高关节点估计的精度。

## 迭代误差反馈模型

这种算法的动机是希望网络学习到一个多阶段反馈的模型，论文题目为[Human pose estimation with iterative error feedback](http://openaccess.thecvf.com/content_cvpr_2016/html/Carreira_Human_Pose_Estimation_CVPR_2016_paper.html)

这种方法的思路就是，每轮产生一个关键点预测，然后下一轮将关键点预测图和原始图片一起输入进行纠正

## 基于先验的模型

这种模型的动机就是给网络添加一些先验知识，也就是双源CNN的思想

这种网络的工作方式，与R-CNN系列有相通之处，也是基于区域提议，然后将区域（一个图像块）提议当做先验输入网络，然后区域的地方产生一个Mask，一起输入到网络中，这样就可以产生一个分类之后的区域

这样就可以促使神经网络学到更多的东西

## 基于热力图的方法

这种方法的动机是这样，人体的尺度不一样，那就想办法让网络克服这个问题，学习到关节之间的关系，并且使用了CNN+图模型方法

论文：Joint Training of a Convolutional Network and a Graphical Model for Human Pose Estimation

## 基于树状结构

动机：之前的建模是基于关节之间的关系，那么是否可以对所有关节形成的树状结构进行建模，也就是CNN+树状结构图模型

论文：http://openaccess.thecvf.com/content_cvpr_2016/html/Yang_End-To-End_Learning_of_CVPR_2016_paper.html

但是是一个全连接图，计算量较大，效率较低

## 多阶段回归

动机：图模型的计算效率低，尝试抛弃图模型，使用多阶段回归来保证精确度

方式：使用卷积姿态机，并且使用大卷积核提高感受野，实现多阶段回归（CMU的论文）